--------------------------------- Team DATAWIZ---------------------------------------------------
--------------------------------- Keerthana Mallavarapu --------------------------------------------- 
create database Playstore;

use Playstore;

# 1.	Which apps have the highest rating in the given available dataset- 

SELECT App,Category,Rating,Installs,Reviews
FROM `playstore`.`cleaned_app_data_csv`
WHERE Rating >= 5.0
ORDER BY Reviews desc;


# 2.	What are the number of installs and reviews for the above apps? Return the apps with the highest reviews to the top.

SELECT DISTINCT App,Installs,Reviews
FROM `playstore`.`cleaned_app_data_csv`
WHERE Rating >= 5.0
ORDER BY Reviews desc;


# 3.	Which app has the highest number of reviews? Also, mention the number of reviews and category of the app

SELECT DISTINCT App, Category, Reviews
FROM `playstore`.`cleaned_app_data_csv`
ORDER BY Reviews desc
LIMIT 1;

#Ans: Facebook, 78158306


# 4.	What is the total amount of revenue generated by the google play store by hosting apps? (Whenever a user buys apps  from the google play store, the amount is considered in the revenue)

SELECT SUM(Price*Installs) as total_rev
FROM `playstore`.`cleaned_app_data_csv`
WHERE Price != 0 AND Type = 'Paid';

#Ans: 387380562


#5.	Which Category of google play store apps has the highest number of installs? also, find out the total number of installs for that particular category.

SELECT DISTINCT Category, SUM(Installs) OVER(PARTITION BY Category)  AS high_cat_install
FROM `playstore`.`cleaned_app_data_csv`
ORDER BY high_cat_install DESC;

SELECT DISTINCT Category, SUM(Installs) AS total_inst
FROM `playstore`.`cleaned_app_data_csv`
GROUP BY Category
ORDER BY total_inst DESC;

Ans: GAME ( 35085862717)

# 6.	Which Genre has the most number of published apps

SELECT DISTINCT Genres,COUNT(App) OVER(PARTITION BY Genres) AS app_by_genre
FROM `playstore`.`cleaned_app_data_csv`
ORDER BY app_by_genre DESC;

#Ans: GAME ( 35085862717)

# 7.	Provide the list of all games ordered in such a way that the game that has the highest number of installs is displayed on the top
# (to avoid duplicate results, use distinct)

SELECT DISTINCT App, Category,Installs, DENSE_RANK() OVER(ORDER BY Installs DESC) AS ranking
FROM `playstore`.`cleaned_app_data_csv`
WHERE Category = 'GAME' ;

8.	Provide the list of apps that can work on android version 4.0.3 and UP.

SELECT `App`, `Android Ver`
FROM `playstore`.`cleaned_app_data_csv`
WHERE `Android Ver` = "4.0.3 and up";


# 9.	How many apps from the given data set are free? Also, provide the number of paid apps.

SELECT 
	   SUM(CASE WHEN Type = 'Free' THEN 1 ELSE 0 END) AS number_of_free,
       SUM(CASE WHEN Type = 'Paid' THEN 1 ELSE 0 END) AS number_of_paid
FROM `playstore`.`cleaned_app_data_csv`;

#Ans: Free App = 8715, Paid App = 645


# 10.	Which is the best dating app? (Best dating app is the one having the highest number of Reviews)

SELECT DISTINCT App, DENSE_RANK() OVER(ORDER BY Reviews DESC) AS ranking, Reviews
FROM `playstore`.`cleaned_app_data_csv`
WHERE Category = 'DATING'
GROUP BY App, Category, Reviews ;

#Ans: Zoosk Dating App  Meet Singles

# 11.	Get the number of reviews having positive sentiment and the number of reviews having negative sentiment for the app 10 best foods for you and compare them.

SELECT App, 
SUM(CASE WHEN `Sentiment` = 'Positive' THEN 1 ELSE 0 END) AS pos_review, 
SUM(CASE WHEN `Sentiment` = 'Negative' THEN 1 ELSE 0 END) AS neg_review
FROM `playstore`.`cleaned_review_data_y` WHERE App = "10 Best Foods for you";

# 12.	Which comments of ASUS SuperNote have sentiment polarity and sentiment subjectivity both as 1?

SELECT `Translated Review`, App, Sentiment_Polarity, Sentiment_Subjectivity
FROM `playstore`.`cleaned_review_data_y`
WHERE App = 'ASUS SuperNote'
AND Sentiment_Polarity = 1
AND Sentiment_Subjectivity = 1;

# 13.	Get all the neutral sentiment reviews for the app Abs Training-Burn belly fat 

SELECT App,`Translated Review`,Sentiment
FROM `playstore`.`cleaned_review_data_y`
WHERE App = 'Abs Training Burn belly fat' AND Sentiment = 'Neutral';

# 14. Extract all negative sentiment reviews for Adobe Acrobat Reader with their sentiment polarity and sentiment subjectivity

 SELECT ROW_NUMBER() OVER(ORDER BY App ASC) AS indx, App,`Translated Review`,Sentiment_Polarity,Sentiment_Subjectivity,Sentiment
FROM `playstore`.`cleaned_review_data_y`
WHERE App = 'Adobe Acrobat Reader' AND Sentiment = 'Negative';


